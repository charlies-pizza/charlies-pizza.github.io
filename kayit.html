<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Add Pizza</title>
    <style>
        body {
	        display: flex;
	        flex-direction: column;
	        align-items: center;
	        justify-content: center;
	        height: 100vh;
	        margin: 0;
	        background-color: #f8f8f8;
	        font-family: Arial, sans-serif;
        }
        button, a {
            border: none;
            background-color: #007BFF;
            color: white;
            padding: 25px 25px;
            margin: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #0056b3;
        }

        #Value, #Key, #c{
            font-weight: bold;
            margin: 10px;
			font-size: 36px;
        }

        .kapat {
	        position: fixed;
	        bottom: 0;
 			margin:auto;
	        width: 100%;
	        height: 60px;
			border-radius: 0px;
			font-size: 26px;
            background-color:red;
            padding: 10px;
       		}
 		 hr {
 		   border: 1px solid black;
 		   width:90%;
			}
#video{
	        width: 60%;
}
    </style>
</head>
<body> 
    <video id="video"></video>
    <p id="result"> # # # # # # # # </p>
    <div>
        <button onclick="guncelle(-1); c.innerHTML = Number(c.innerHTML) - 1">➖</button>
        <span id="c">1</span>
        <button onclick="guncelle(1); c.innerHTML = Number(c.innerHTML) + 1">➕</button>
    </div>
    <hr>
    Mobil Nummer:
    <span id="Key">key</span><hr>
    Totalt Pizza!
    <span id="Value"></span>


<script type="text/javascript" src="https://unpkg.com/@zxing/library@latest"></script>

    <script type="module">
       
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";
        const firebaseConfig = { databaseURL: "https://bestill-pizza-default-rtdb.europe-west1.firebasedatabase.app" };
           
        initializeApp(firebaseConfig);
        const database = getDatabase();
        
		const urlParams = new URLSearchParams(window.location.search);
		const specificKey = urlParams.get("n");
        const specificKeyReference = ref(database, specificKey);

	    onValue(specificKeyReference, (snapshot) => {
	        demo.innerHTML = snapshot.val();
	        Key.innerHTML = snapshot.key;
	    });

        window.guncelle = function(increment) {
            let value = Number(Value.innerHTML) + increment;
            if (value >= 0 && value <= 10) {
                Value.innerHTML = value;
                set(specificKeyReference, value);
            } else {
                set(specificKeyReference, 0);
            }
        }
        
        window.onload = function() {
            setTimeout(() => { guncelle(Number(c.innerHTML)); }, 500);
        }

const codeReader = new ZXing.BrowserQRCodeReader();
const output = document.getElementById('result');
const sound = new Audio("https://bestill.online/img/register.mp3");

function decode() {
    codeReader.decodeFromInputVideoDevice(undefined, 'video')
        .then(result => {

window.location.href = result.text;

            output.textContent = result.text.substring(result.text.length - 8);
            sound.play();

            setTimeout(decode, 1000);
        })
        .catch(err => console.error(err));
}

decode();
    </script>
</body>
</html>
