<table id="demo">   </table>

<script type="module">
 let status = true;
 
 import { initializeApp } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-app.js";
 import { getDatabase, ref, onValue, set, remove, update } from "https://www.gstatic.com/firebasejs/9.14.0/firebase-database.js";
 const firebaseConfig = { databaseURL: "https://charlies-pizza-default-rtdb.europe-west1.firebasedatabase.app",
      };

 // Firebase yapılandırmasını başlat
 initializeApp(firebaseConfig);
 const database = getDatabase();
 const commentsReference = ref(database);

 function saklananSifreyiKontrolEt() {
  let saklananSifre = localStorage.getItem("sifre");
  let dogruSifre = "1919";

  if (saklananSifre === dogruSifre) {
    calistir();
    return true;
  }

  return false;
}

function sifreAl() {
  if (saklananSifreyiKontrolEt()) {
    return;
  }

  let sifre = prompt("Lütfen şifrenizi girin", "");
  let dogruSifre = "1919";

  if (sifre === dogruSifre) {
    localStorage.setItem("sifre", sifre);
    alert("Şifre doğru!");
    calistir();
  } else {
    alert("Yanlış şifre. Lütfen tekrar deneyin.");
  }
}

if (!saklananSifreyiKontrolEt()) {
  sifreAl();
}

function calistir() {
    
 const urlParams = new URLSearchParams(window.location.search);
 const nValue = urlParams.get("n"); 
 
 onValue(commentsReference, (snapshot) => {
  demo.innerHTML = "";
 
  const jsonString = JSON.stringify(snapshot);
  const parsedObject = JSON.parse(jsonString);
  
  let found = false;
  for (const key in parsedObject) {
    if (key === nValue) {
      found = true;

if (Number(parsedObject[key]) > 10) {
    set(ref(database, nValue), 0);
 }

    if (status == true) {
    setTimeout(() => {
    set(ref(database, nValue), Number(parsedObject[key]) + 1);
    }, 100);
    status = false;
    }
      demo.innerHTML = ``;
      break;
    }
  }
  if (!found) {
    set(ref(database, nValue), 0);
  }
  setInterval(() => {
    window.location.href = "https://www.bestill.online";
  }, 10);

});
}
</script>
